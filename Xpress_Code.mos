model ModelName
uses "mmxprs"; !gain access to the Xpress-Optimizer solver


declarations
	N = 1..20
	MaxN = 20
  	X: array(N, N) of mpvar
  	C: array(N, N) of real
  	U: array(N) of mpvar
  	Objective:linctr
end-declarations
	
	C::[0, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 0, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 0, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 0, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 0, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 0, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 0, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 0, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 0, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 0, 23, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 0, 23, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 0, 25, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 0, 12, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 0, 14, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 0, 24, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 0, 53, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 0, 24, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 0, 24, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 0, 21,
		10, 10, 30, 40, 10, 20, 30, 15, 23, 52, 23, 23, 25, 12, 14, 24, 53, 24, 24, 0]    ! 20x20  Sol: 483
	
	!C::[-1, 1382409430, 0, 293434487, 345240004, 0, 451493016, 0, 303974633, 1369648003, 28207301, 0, 2070599808, 1606536049, 0,
	!1382409430, -1, 2094401164, 1215669313, 1276354626, 1996081688, 1756736302, 0, 1351699331, 261541134, 232577535, 305020423, 2113360496, 0, 81654289,
	!0, 2094401164, -1, 903526446, 953478436, 1052764839, 535647116, 0, 1593865164, 356446428, 1150991625, 113362810, 1459276579, 216312618, 1520250450,
	!293434487, 1215669313, 903526446, -1, 329742798, 922587916, 76381402, 0, 539882243, 0, 0, 890674640, 671142049, 676953792, 1802088205,
	!345240004, 1276354626, 953478436, 329742798, -1, 0, 1207662354, 1326466291, 933117477, 1918417495, 0, 489502716, 356668267, 213817885, 1062313163,
	!0, 1996081688, 1052764839, 922587916, 0, -1, 1386667230, 833408951, 1565899048, 1791210694, 1345782371, 1121335072, 0, 0, 175975777,
	!451493016, 1756736302, 535647116, 76381402, 1207662354, 1386667230, -1, 417107641, 1097060999, 993473681, 1496335735, 0, 813989696, 0, 0,
	!0, 0, 0, 0, 1326466291, 833408951, 417107641, -1, 835673970, 1129157084, 2044240635, 0, 353510454, 1487985060, 273997423,
	!303974633, 1351699331, 1593865164, 539882243, 933117477, 1565899048, 1097060999, 835673970, -1, 1914339693, 391375939, 0, 1546806541, 0, 0,
	!1369648003, 261541134, 356446428, 0, 1918417495, 1791210694, 993473681, 1129157084, 1914339693, -1, 369724796, 2043587518, 815392124, 1496130735, 1162193659,
	!28207301, 232577535, 1150991625, 0, 0, 1345782371, 1496335735, 2044240635, 391375939, 369724796, -1, 0, 1850175085, 2138481622, 0,
	!0, 305020423, 113362810, 890674640, 489502716, 1121335072, 0, 0, 0, 2043587518, 0, -1, 1823812937, 1006446902, 996299537,
	!2070599808, 2113360496, 1459276579, 671142049, 356668267, 0, 813989696, 353510454, 1546806541, 815392124, 1850175085, 1823812937, -1, 512434858, 739662484,
	!1606536049, 0, 216312618, 676953792, 213817885, 0, 0, 1487985060, 0, 1496130735, 2138481622, 1006446902, 512434858, -1, 0,
	!0, 81654289, 1520250450, 1802088205, 1062313163, 175975777, 0, 273997423, 0, 1162193659, 0, 996299537, 739662484, 0, -1]					! 15x15
	
	
	!C::[-1, 1276187355, 1295015094, 0, 2127539439, 0, 137007359,
	!	0, -1, 35353449, 1114097547, 1336973946, 0, 1308971914,
	!	1620590276, 403912175, -1, 1505099930, 71077453, 383432075, 867623036,
	!	777759180, 270517462, 0, -1, 358390974, 0, 0,
	!	0, 0, 0, 1599006934, -1, 294989566, 40180757,
	!	1296226494, 1966149758, 1031458374, 1104222152, 730836748, -1, 652510611,
	!	1019859661, 1191876182, 0, 0, 709469451, 0, -1]
	
	
 	!C::[0, 15, 25, 35, 35, 25,
  	!	15, 0, 30, 40, 25, 15,
  	!	25, 30, 0, 20, 30, 25,
  	!	35, 40, 20, 0, 20, 30,
  	!	35, 25, 35, 20, 0, 19,
  	!	25, 15, 25, 30, 19, 0]			! 114 for 6x6
  	
  	!C:: [0, 786, 549, 657, 331, 559, 250,
     !786, 0, 668, 979, 593, 224, 905,
     !549, 668, 0, 316, 607, 472, 467,
     !657, 979, 316, 0, 890, 769, 400,
     !331, 593, 607, 890, 0, 386, 559,
     !559, 224, 472, 769, 386, 0, 681,
     !250, 905, 467, 400, 559, 681, 0]   = 2575 (7 nodes)


writeln("Begin running model")

	Problem:=sum(i,j in N | i<>j) C(i,j)*X(i,j)
	
	forall(j in N)
	sum(i in N | i<>j) X(i,j)= 1
	
	forall(j in N)
	sum(i in N | i<>j) X(j,i)= 1
	
	forall(i,j in N | j<>1 and i<>j)
	U(j)>=U(i)+1-MaxN*(1-X(i,j))
	
	U(1)=0
	
	forall(i in N)
	U(i)>=0
	
	forall(i,j in N | i<>j) X(i,j) is_binary
	
	minimize(Problem)
	
	writeln("\nObjectibe Solution: ", getobjval)
	writeln("")
	forall(j in N) writeln("Node:", j, " Visition Order:", getsol(U(j)))
	writeln("")
	forall(i,j in N | getsol(X(i,j))<>0) writeln("i:", i, " j:", j, " X(i,j):", getsol(X(i,j)), " Order:", getsol(U(i)))
	writeln("")
	
	
writeln("End running model")

end-model
